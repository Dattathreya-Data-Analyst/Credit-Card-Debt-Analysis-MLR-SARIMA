legend.title = element_text(face = "bold"),
panel.grid.major = element_line(color = "grey90"),
panel.grid.minor = element_line(color = "grey95")
)
)
mlr_data <- read_csv("E:/NCI Classes/Statistics and Optimisation/CA/mlr_data (2)/mlr1.csv")
head(mlr_data, 10)
str(mlr_data)
summary(mlr_data)
ts_data <- read.csv("E:/NCI Classes/Statistics and Optimisation/CA/ts_data/ts1.csv")
head(ts_data, 10)
str(ts_data)
summary(ts_data)
#2.1 Multiple Linear Regression
cat("\n=== MLR DATASET LOADED ===\n")
cat(paste("Dimensions:", dim(mlr_data)[1], "×", dim(mlr_data)[2], "\n"))
DEPENDENT_VAR <- "y"
INDEPENDENT_VARS <- c("x1", "x2", "x3")
cat(paste("Dependent Variable:", DEPENDENT_VAR, "\n"))
cat(paste("Independent Variables:", paste(INDEPENDENT_VARS, collapse = ", "), "\n"))
mlr_data$x3 <- factor(mlr_data$x3, levels = c("A", "B", "C"))
cat(paste("x3 levels:", paste(levels(mlr_data$x3), collapse = ", "), "\n"))
cat("\n=== ADVANCED EXPLORATORY DATA ANALYSIS ===\n")
# Comprehensive descriptive statistics by variable type
descriptive_stats <- list(
Continuous = mlr_data %>%
select(y, x1, x2) %>%
summarise(across(everything(), list(
Mean = ~mean(.x, na.rm = TRUE),
Median = ~median(.x, na.rm = TRUE),
SD = ~sd(.x, na.rm = TRUE),
CV = ~sd(.x, na.rm = TRUE)/mean(.x, na.rm = TRUE) * 100,
Min = ~min(.x, na.rm = TRUE),
Max = ~max(.x, na.rm = TRUE),
Skewness = ~moments::skewness(.x, na.rm = TRUE),
Kurtosis = ~moments::kurtosis(.x, na.rm = TRUE) - 3,
IQR = ~IQR(.x, na.rm = TRUE),
Range = ~diff(range(.x, na.rm = TRUE))
))) %>% pivot_longer(everything(), names_to = "Statistic", values_to = "Value"),
Categorical = mlr_data %>%
count(x3) %>%
mutate(Percentage = n/sum(n) * 100)
)
# Save tables
kable(descriptive_stats$Continuous, digits = 3, caption = "Descriptive Statistics: Continuous Variables") %>%
kable_styling(latex_options = "scale_down") %>%
save_kable("output_tables/mlr_continuous_stats.png")
kable(descriptive_stats$Categorical, digits = 1, caption = "Descriptive Statistics: Categorical Variable (x3)") %>%
save_kable("output_tables/mlr_categorical_stats.png")
# Enhanced correlation analysis
cat("\n=== CORRELATION ANALYSIS ===\n")
numeric_data <- mlr_data %>% select(y, x1, x2)
correlation_matrix <- cor(numeric_data, use = "complete.obs")
# Visual correlation matrix
corrplot(correlation_matrix,
method = "color",
type = "full",
tl.col = "black",
tl.srt = 0,
addCoef.col = "black",
number.cex = 1.2,
title = "Correlation Matrix: Numerical Variables",
mar = c(0,0,2,0))
ggsave("output_figures/mlr_correlation_matrix.png", width = 8, height = 6, dpi = 300)
# Correlation with dependent variable
dep_correlations <- data.frame(
Predictor = c("x1", "x2"),
Correlation = correlation_matrix["y", c("x1", "x2")],
Interpretation = ifelse(
abs(correlation_matrix["y", c("x1", "x2")]) > 0.7, "Strong",
ifelse(abs(correlation_matrix["y", c("x1", "x2")]) > 0.5, "Moderate",
ifelse(abs(correlation_matrix["y", c("x1", "x2")]) > 0.3, "Weak", "Negligible"))
)
)
kable(dep_correlations, digits = 3, caption = "Correlation with Dependent Variable (y)") %>%
save_kable("output_tables/mlr_dep_correlations.md")
dist_plots <- lapply(c("y", "x1", "x2"), function(var) {
p <- ggplot(mlr_data, aes_string(x = var)) +
geom_histogram(aes(y = ..density..), bins = 30, fill = "steelblue", alpha = 0.8) +
geom_density(color = "red", size = 1.2) +
stat_function(fun = dnorm,
args = list(mean = mean(mlr_data[[var]], na.rm = TRUE),
sd = sd(mlr_data[[var]], na.rm = TRUE)),
color = "darkgreen", size = 1, linetype = "dashed") +
labs(title = paste("Distribution of", var),
subtitle = paste("Skewness:", round(moments::skewness(mlr_data[[var]], na.rm = TRUE), 2),
"| Kurtosis:", round(moments::kurtosis(mlr_data[[var]], na.rm = TRUE) - 3, 2))) +
theme(plot.title = element_text(hjust = 0.5))
return(p)
})
x3_plot <- ggplot(mlr_data, aes(x = x3)) +
geom_bar(fill = "steelblue", alpha = 0.8) +
geom_text(stat = "count", aes(label = after_stat(count)), vjust = -0.5) +
labs(title = "Distribution of x3 (Categorical)",
subtitle = paste("Levels:", paste(levels(mlr_data$x3), collapse = ", "))) +
theme(plot.title = element_text(hjust = 0.5))
pdf("output_figures/mlr_distributions.pdf", width = 14, height = 10)
grid.arrange(grobs = c(dist_plots, list(x3_plot)), ncol = 2, nrow = 2)
dev.off()
# 2. Boxplots for outlier visualization
box_plots <- lapply(c("y", "x1", "x2"), function(var) {
ggplot(mlr_data, aes_string(x = "1", y = var)) +
geom_boxplot(fill = "lightblue", outlier.color = "red", outlier.size = 2) +
stat_summary(fun = mean, geom = "point", color = "darkgreen", size = 3) +
labs(title = paste("Boxplot of", var), x = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
})
pdf("output_figures/mlr_boxplots.pdf", width = 12, height = 4)
grid.arrange(grobs = box_plots, ncol = 3)
dev.off()
install.packages("GGally")
ID <- 24212881
LAST_DIGIT <- ID %% 10
set.seed(ID)
dir.create("output_figures", showWarnings = FALSE)
dir.create("output_tables", showWarnings = FALSE)
required_packages <- c(
"tidyverse", "ggplot2", "gridExtra", "corrplot", "car", "performance",
"olsrr", "forecast", "tseries", "zoo", "lubridate", "knitr", "kableExtra",
"sjPlot", "patchwork", "moments", "outliers"
)
new_packages <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
lapply(required_packages, library, character.only = TRUE)
theme_set(
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
axis.title = element_text(face = "bold"),
legend.title = element_text(face = "bold"),
panel.grid.major = element_line(color = "grey90"),
panel.grid.minor = element_line(color = "grey95")
)
)
mlr_data <- read_csv("E:/NCI Classes/Statistics and Optimisation/CA/mlr_data (2)/mlr1.csv")
head(mlr_data, 10)
str(mlr_data)
summary(mlr_data)
ts_data <- read.csv("E:/NCI Classes/Statistics and Optimisation/CA/ts_data/ts1.csv")
head(ts_data, 10)
str(ts_data)
summary(ts_data)
#2.1 Multiple Linear Regression
cat("\n=== MLR DATASET LOADED ===\n")
cat(paste("Dimensions:", dim(mlr_data)[1], "×", dim(mlr_data)[2], "\n"))
DEPENDENT_VAR <- "y"
INDEPENDENT_VARS <- c("x1", "x2", "x3")
cat(paste("Dependent Variable:", DEPENDENT_VAR, "\n"))
cat(paste("Independent Variables:", paste(INDEPENDENT_VARS, collapse = ", "), "\n"))
mlr_data$x3 <- factor(mlr_data$x3, levels = c("A", "B", "C"))
cat(paste("x3 levels:", paste(levels(mlr_data$x3), collapse = ", "), "\n"))
cat("\n=== ADVANCED EXPLORATORY DATA ANALYSIS ===\n")
# Comprehensive descriptive statistics by variable type
descriptive_stats <- list(
Continuous = mlr_data %>%
select(y, x1, x2) %>%
summarise(across(everything(), list(
Mean = ~mean(.x, na.rm = TRUE),
Median = ~median(.x, na.rm = TRUE),
SD = ~sd(.x, na.rm = TRUE),
CV = ~sd(.x, na.rm = TRUE)/mean(.x, na.rm = TRUE) * 100,
Min = ~min(.x, na.rm = TRUE),
Max = ~max(.x, na.rm = TRUE),
Skewness = ~moments::skewness(.x, na.rm = TRUE),
Kurtosis = ~moments::kurtosis(.x, na.rm = TRUE) - 3,
IQR = ~IQR(.x, na.rm = TRUE),
Range = ~diff(range(.x, na.rm = TRUE))
))) %>% pivot_longer(everything(), names_to = "Statistic", values_to = "Value"),
Categorical = mlr_data %>%
count(x3) %>%
mutate(Percentage = n/sum(n) * 100)
)
# Save tables
kable(descriptive_stats$Continuous, digits = 3, caption = "Descriptive Statistics: Continuous Variables") %>%
kable_styling(latex_options = "scale_down") %>%
save_kable("output_tables/mlr_continuous_stats.png")
kable(descriptive_stats$Categorical, digits = 1, caption = "Descriptive Statistics: Categorical Variable (x3)") %>%
save_kable("output_tables/mlr_categorical_stats.png")
# Enhanced correlation analysis
cat("\n=== CORRELATION ANALYSIS ===\n")
numeric_data <- mlr_data %>% select(y, x1, x2)
correlation_matrix <- cor(numeric_data, use = "complete.obs")
# Visual correlation matrix
corrplot(correlation_matrix,
method = "color",
type = "full",
tl.col = "black",
tl.srt = 0,
addCoef.col = "black",
number.cex = 1.2,
title = "Correlation Matrix: Numerical Variables",
mar = c(0,0,2,0))
ggsave("output_figures/mlr_correlation_matrix.png", width = 8, height = 6, dpi = 300)
# Correlation with dependent variable
dep_correlations <- data.frame(
Predictor = c("x1", "x2"),
Correlation = correlation_matrix["y", c("x1", "x2")],
Interpretation = ifelse(
abs(correlation_matrix["y", c("x1", "x2")]) > 0.7, "Strong",
ifelse(abs(correlation_matrix["y", c("x1", "x2")]) > 0.5, "Moderate",
ifelse(abs(correlation_matrix["y", c("x1", "x2")]) > 0.3, "Weak", "Negligible"))
)
)
kable(dep_correlations, digits = 3, caption = "Correlation with Dependent Variable (y)") %>%
save_kable("output_tables/mlr_dep_correlations.md")
dist_plots <- lapply(c("y", "x1", "x2"), function(var) {
p <- ggplot(mlr_data, aes_string(x = var)) +
geom_histogram(aes(y = ..density..), bins = 30, fill = "steelblue", alpha = 0.8) +
geom_density(color = "red", size = 1.2) +
stat_function(fun = dnorm,
args = list(mean = mean(mlr_data[[var]], na.rm = TRUE),
sd = sd(mlr_data[[var]], na.rm = TRUE)),
color = "darkgreen", size = 1, linetype = "dashed") +
labs(title = paste("Distribution of", var),
subtitle = paste("Skewness:", round(moments::skewness(mlr_data[[var]], na.rm = TRUE), 2),
"| Kurtosis:", round(moments::kurtosis(mlr_data[[var]], na.rm = TRUE) - 3, 2))) +
theme(plot.title = element_text(hjust = 0.5))
return(p)
})
x3_plot <- ggplot(mlr_data, aes(x = x3)) +
geom_bar(fill = "steelblue", alpha = 0.8) +
geom_text(stat = "count", aes(label = after_stat(count)), vjust = -0.5) +
labs(title = "Distribution of x3 (Categorical)",
subtitle = paste("Levels:", paste(levels(mlr_data$x3), collapse = ", "))) +
theme(plot.title = element_text(hjust = 0.5))
pdf("output_figures/mlr_distributions.pdf", width = 14, height = 10)
grid.arrange(grobs = c(dist_plots, list(x3_plot)), ncol = 2, nrow = 2)
dev.off()
# 2. Boxplots for outlier visualization
box_plots <- lapply(c("y", "x1", "x2"), function(var) {
ggplot(mlr_data, aes_string(x = "1", y = var)) +
geom_boxplot(fill = "lightblue", outlier.color = "red", outlier.size = 2) +
stat_summary(fun = mean, geom = "point", color = "darkgreen", size = 3) +
labs(title = paste("Boxplot of", var), x = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
})
pdf("output_figures/mlr_boxplots.pdf", width = 12, height = 4)
grid.arrange(grobs = box_plots, ncol = 3)
dev.off()
install.packages("GGally")
install.packages("GGally")
x3_plot <- ggplot(mlr_data, aes(x = x3)) +
geom_bar(fill = "steelblue", alpha = 0.8) +
geom_text(stat = "count", aes(label = after_stat(count)), vjust = -0.5) +
labs(title = "Distribution of x3 (Categorical)",
subtitle = paste("Levels:", paste(levels(mlr_data$x3), collapse = ", "))) +
theme(plot.title = element_text(hjust = 0.5))
pdf("output_figures/mlr_distributions.pdf", width = 14, height = 10)
grid.arrange(grobs = c(dist_plots, list(x3_plot)), ncol = 2, nrow = 2)
dev.off()
# 2. Boxplots for outlier visualization
box_plots <- lapply(c("y", "x1", "x2"), function(var) {
ggplot(mlr_data, aes_string(x = "1", y = var)) +
geom_boxplot(fill = "lightblue", outlier.color = "red", outlier.size = 2) +
stat_summary(fun = mean, geom = "point", color = "darkgreen", size = 3) +
labs(title = paste("Boxplot of", var), x = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
})
pdf("output_figures/mlr_boxplots.pdf", width = 12, height = 4)
grid.arrange(grobs = box_plots, ncol = 3)
dev.off()
install.packages("GGally")
cat("\n=== GAUSS-MARKOV ASSUMPTIONS VERIFICATION ===\n")
library(ggplot2)
linearity_plot <- ggplot(best_model, aes(.fitted, .resid)) +
geom_point(alpha = 0.6, color = "steelblue", size = 1.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
geom_smooth(se = FALSE, color = "darkgreen", size = 1) +
labs(title = "Assumption 1 & 4: Linearity & Zero Conditional Mean",
subtitle = "Residuals vs Fitted Values",
x = "Fitted Values", y = "Residuals") +
theme(plot.title = element_text(hjust = 0.5))
linearity_plot
library(lmtest)  # for bptest()
library(car)     # for ncvTest()
library(broom)   # for augment() and .fitted/.resid
bp_test <- bptest(best_model)
bp_test
ncv_test <- ncvTest(best_model)
heteroskedasticity_plot <- ggplot(best_model, aes(.fitted, sqrt(abs(.resid)))) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_smooth(se = FALSE, color = "darkgreen") +
labs(title = "Assumption 2: Homoscedasticity Check",
subtitle = paste("Breusch-Pagan p =", round(bp_test$p.value, 4)),
x = "Fitted Values", y = "√|Residuals|") +
theme(plot.title = element_text(hjust = 0.5))
dw_stat <- durbinWatsonTest(best_model)$stat
cat(paste("Durbin-Watson statistic:", (dw_stat)))
shapiro_test <- shapiro.test(residuals(best_model))
normality_plot <- ggplot(best_model, aes(sample = .resid)) +
stat_qq(color = "steelblue", size = 1.5) +
stat_qq_line(color = "red", linetype = "dashed") +
labs(title = "Assumption 3: Normality of Residuals",
subtitle = paste("Shapiro-Wilk p =", round(shapiro_test$p.value, 4)),
x = "Theoretical Quantiles", y = "Sample Quantiles") +
theme(plot.title = element_text(hjust = 0.5))
library(ggplot2)
linearity_plot <- ggplot(best_model, aes(.fitted, .resid)) +
geom_point(alpha = 0.6, color = "steelblue", size = 1.5) +
geom_hline(yintercept = 0, linetype = "dashed", color = "red") +
geom_smooth(se = FALSE, color = "darkgreen", size = 1) +
labs(title = "Assumption 1 & 4: Linearity & Zero Conditional Mean",
subtitle = "Residuals vs Fitted Values",
x = "Fitted Values", y = "Residuals") +
theme(plot.title = element_text(hjust = 0.5))
linearity_plot
library(lmtest)  # for bptest()
library(car)     # for ncvTest()
library(broom)   # for augment() and .fitted/.resid
bp_test <- bptest(best_model)
bp_test
ncv_test <- ncvTest(best_model)
heteroskedasticity_plot <- ggplot(best_model, aes(.fitted, sqrt(abs(.resid)))) +
geom_point(alpha = 0.6, color = "steelblue") +
geom_smooth(se = FALSE, color = "darkgreen") +
labs(title = "Assumption 2: Homoscedasticity Check",
subtitle = paste("Breusch-Pagan p =", round(bp_test$p.value, 4)),
x = "Fitted Values", y = "√|Residuals|") +
theme(plot.title = element_text(hjust = 0.5))
dw_stat <- durbinWatsonTest(best_model)$stat
cat(paste("Durbin-Watson statistic:", (dw_stat)))
shapiro_test <- shapiro.test(residuals(best_model))
normality_plot <- ggplot(best_model, aes(sample = .resid)) +
stat_qq(color = "steelblue", size = 1.5) +
stat_qq_line(color = "red", linetype = "dashed") +
labs(title = "Assumption 3: Normality of Residuals",
subtitle = paste("Shapiro-Wilk p =", round(shapiro_test$p.value, 4)),
x = "Theoretical Quantiles", y = "Sample Quantiles") +
theme(plot.title = element_text(hjust = 0.5))
vif_values <- car::vif(best_model)
multicollinearity_table <- data.frame(
Variable = names(vif_values),
VIF = vif_values,
Tolerance = 1/vif_values,
Interpretation = ifelse(vif_values >= 10, "Severe",
ifelse(vif_values >= 5, "Moderate",
ifelse(vif_values >= 2.5, "Low", "None")))
)
kable(multicollinearity_table, digits = 3, caption = "Assumption 5: Multicollinearity Check (VIF)") %>%
save_kable("output_tables/mlr_multicollinearity.png")
ID <- 24212881
LAST_DIGIT <- ID %% 10
set.seed(ID)
dir.create("output_figures", showWarnings = FALSE)
dir.create("output_tables", showWarnings = FALSE)
required_packages <- c(
"tidyverse", "ggplot2", "gridExtra", "corrplot", "car", "performance",
"olsrr", "forecast", "tseries", "zoo", "lubridate", "knitr", "kableExtra",
"sjPlot", "patchwork", "moments", "outliers"
)
new_packages <- required_packages[!(required_packages %in% installed.packages()[,"Package"])]
if(length(new_packages)) install.packages(new_packages)
lapply(required_packages, library, character.only = TRUE)
theme_set(
theme_minimal(base_size = 11) +
theme(
plot.title = element_text(face = "bold", hjust = 0.5),
axis.title = element_text(face = "bold"),
legend.title = element_text(face = "bold"),
panel.grid.major = element_line(color = "grey90"),
panel.grid.minor = element_line(color = "grey95")
)
)
mlr_data <- read_csv("E:/NCI Classes/Statistics and Optimisation/CA/mlr_data (2)/mlr1.csv")
head(mlr_data, 10)
str(mlr_data)
summary(mlr_data)
ts_data <- read.csv("E:/NCI Classes/Statistics and Optimisation/CA/ts_data/ts1.csv")
head(ts_data, 10)
str(ts_data)
summary(ts_data)
cat("\n=== MLR DATASET LOADED ===\n")
cat(paste("Dimensions:", dim(mlr_data)[1], "×", dim(mlr_data)[2], "\n"))
DEPENDENT_VAR <- "y"
INDEPENDENT_VARS <- c("x1", "x2", "x3")
cat(paste("Dependent Variable:", DEPENDENT_VAR, "\n"))
cat(paste("Independent Variables:", paste(INDEPENDENT_VARS, collapse = ", "), "\n"))
mlr_data$x3 <- factor(mlr_data$x3, levels = c("A", "B", "C"))
cat(paste("x3 levels:", paste(levels(mlr_data$x3), collapse = ", "), "\n"))
cat("\n=== ADVANCED EXPLORATORY DATA ANALYSIS ===\n")
# Comprehensive descriptive statistics by variable type
descriptive_stats <- list(
Continuous = mlr_data %>%
select(y, x1, x2) %>%
summarise(across(everything(), list(
Mean = ~mean(.x, na.rm = TRUE),
Median = ~median(.x, na.rm = TRUE),
SD = ~sd(.x, na.rm = TRUE),
CV = ~sd(.x, na.rm = TRUE)/mean(.x, na.rm = TRUE) * 100,
Min = ~min(.x, na.rm = TRUE),
Max = ~max(.x, na.rm = TRUE),
Skewness = ~moments::skewness(.x, na.rm = TRUE),
Kurtosis = ~moments::kurtosis(.x, na.rm = TRUE) - 3,
IQR = ~IQR(.x, na.rm = TRUE),
Range = ~diff(range(.x, na.rm = TRUE))
))) %>% pivot_longer(everything(), names_to = "Statistic", values_to = "Value"),
Categorical = mlr_data %>%
count(x3) %>%
mutate(Percentage = n/sum(n) * 100)
)
# Save tables
kable(descriptive_stats$Continuous, digits = 3, caption = "Descriptive Statistics: Continuous Variables") %>%
kable_styling(latex_options = "scale_down") %>%
save_kable("output_tables/mlr_continuous_stats.png")
kable(descriptive_stats$Categorical, digits = 1, caption = "Descriptive Statistics: Categorical Variable (x3)") %>%
save_kable("output_tables/mlr_categorical_stats.png")
# Enhanced correlation analysis
cat("\n=== CORRELATION ANALYSIS ===\n")
numeric_data <- mlr_data %>% select(y, x1, x2)
correlation_matrix <- cor(numeric_data, use = "complete.obs")
# Visual correlation matrix
corrplot(correlation_matrix,
method = "color",
type = "full",
tl.col = "black",
tl.srt = 0,
addCoef.col = "black",
number.cex = 1.2,
title = "Correlation Matrix: Numerical Variables",
mar = c(0,0,2,0))
ggsave("output_figures/mlr_correlation_matrix.png", width = 8, height = 6, dpi = 300)
# Correlation with dependent variable
dep_correlations <- data.frame(
Predictor = c("x1", "x2"),
Correlation = correlation_matrix["y", c("x1", "x2")],
Interpretation = ifelse(
abs(correlation_matrix["y", c("x1", "x2")]) > 0.7, "Strong",
ifelse(abs(correlation_matrix["y", c("x1", "x2")]) > 0.5, "Moderate",
ifelse(abs(correlation_matrix["y", c("x1", "x2")]) > 0.3, "Weak", "Negligible"))
)
)
kable(dep_correlations, digits = 3, caption = "Correlation with Dependent Variable (y)") %>%
save_kable("output_tables/mlr_dep_correlations.png")
dist_plots <- lapply(c("y", "x1", "x2"), function(var) {
p <- ggplot(mlr_data, aes_string(x = var)) +
geom_histogram(aes(y = ..density..), bins = 30, fill = "steelblue", alpha = 0.8) +
geom_density(color = "red", size = 1.2) +
stat_function(fun = dnorm,
args = list(mean = mean(mlr_data[[var]], na.rm = TRUE),
sd = sd(mlr_data[[var]], na.rm = TRUE)),
color = "darkgreen", size = 1, linetype = "dashed") +
labs(title = paste("Distribution of", var),
subtitle = paste("Skewness:", round(moments::skewness(mlr_data[[var]], na.rm = TRUE), 2),
"| Kurtosis:", round(moments::kurtosis(mlr_data[[var]], na.rm = TRUE) - 3, 2))) +
theme(plot.title = element_text(hjust = 0.5))
return(p)
})
x3_plot <- ggplot(mlr_data, aes(x = x3)) +
geom_bar(fill = "steelblue", alpha = 0.8) +
geom_text(stat = "count", aes(label = after_stat(count)), vjust = -0.5) +
labs(title = "Distribution of x3 (Categorical)",
subtitle = paste("Levels:", paste(levels(mlr_data$x3), collapse = ", "))) +
theme(plot.title = element_text(hjust = 0.5))
pdf("output_figures/mlr_distributions.pdf", width = 14, height = 10)
grid.arrange(grobs = c(dist_plots, list(x3_plot)), ncol = 2, nrow = 2)
dev.off()
# 2. Boxplots for outlier visualization
box_plots <- lapply(c("y", "x1", "x2"), function(var) {
ggplot(mlr_data, aes_string(x = "1", y = var)) +
geom_boxplot(fill = "lightblue", outlier.color = "red", outlier.size = 2) +
stat_summary(fun = mean, geom = "point", color = "darkgreen", size = 3) +
labs(title = paste("Boxplot of", var), x = NULL) +
theme(
plot.title = element_text(hjust = 0.5),
axis.text.x = element_blank(),
axis.ticks.x = element_blank()
)
})
pdf("output_figures/mlr_boxplots.pdf", width = 12, height = 4)
grid.arrange(grobs = box_plots, ncol = 3)
dev.off()
install.packages("GGally")
library(GGally)
# 3. Scatterplot matrix with regression lines
scatter_matrix <- ggpairs(mlr_data,
columns = 1:3,
upper = list(continuous = wrap("cor", size = 3)),
lower = list(continuous = wrap("smooth", alpha = 0.6)),
diag = list(continuous = wrap("densityDiag")),
title = "Scatterplot Matrix with Correlations") +
theme(plot.title = element_text(hjust = 0.5, size = 16))
ggsave("output_figures/mlr_scatter_matrix.png", scatter_matrix, width = 10, height = 10, dpi = 300)
# 4. Interaction visualization: y ~ x1 by x3
interaction_plot <- ggplot(mlr_data, aes(x = x1, y = y, color = x3, group = x3)) +
geom_point(alpha = 0.6, size = 2) +
geom_smooth(method = "lm", se = FALSE, size = 1.2) +
labs(title = "Relationship between y and x1 by x3 Category",
subtitle = "Testing for interaction effects",
x = "x1", y = "y", color = "x3") +
theme(plot.title = element_text(hjust = 0.5))
ggsave("output_figures/mlr_interaction_x1_x3.png", interaction_plot, width = 10, height = 6, dpi = 300)
# 5. Violin plots for x3 effect
violin_plot <- ggplot(mlr_data, aes(x = x3, y = y, fill = x3)) +
geom_violin(alpha = 0.7) +
geom_boxplot(width = 0.1, fill = "white") +
stat_summary(fun = "mean", geom = "point", shape = 23, size = 4, fill = "black") +
labs(title = "Distribution of y across x3 Categories",
x = "x3", y = "y") +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(values = c("A" = "#E69F00", "B" = "#56B4E9", "C" = "#009E73"))
